<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_25) on Wed May 27 23:07:38 IST 2015 -->
<title>PassphraseSecrets</title>
<meta name="date" content="2015-05-27">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="PassphraseSecrets";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":9,"i1":10,"i2":9,"i3":10,"i4":9};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../info/guardianproject/cacheword/ICacheWordSubscriber.html" title="interface in info.guardianproject.cacheword"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../info/guardianproject/cacheword/PassphraseSecretsImpl.html" title="class in info.guardianproject.cacheword"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?info/guardianproject/cacheword/PassphraseSecrets.html" target="_top">Frames</a></li>
<li><a href="PassphraseSecrets.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">info.guardianproject.cacheword</div>
<h2 title="Class PassphraseSecrets" class="title">Class PassphraseSecrets</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>info.guardianproject.cacheword.PassphraseSecrets</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../info/guardianproject/cacheword/ICachedSecrets.html" title="interface in info.guardianproject.cacheword">ICachedSecrets</a></dd>
</dl>
<hr>
<br>
<pre>public class <span class="typeNameLabel">PassphraseSecrets</span>
extends java.lang.Object
implements <a href="../../../info/guardianproject/cacheword/ICachedSecrets.html" title="interface in info.guardianproject.cacheword">ICachedSecrets</a></pre>
<div class="block">Represents a single 256 AES secret encrypted with a key derived from the
 user's passphrase. This class handles the PBE key derivation, secret key
 generation, encryption, and persistence. It also provides a means for
 fetching (decrypting) the secrets and changing the passphrase. This is the
 simplest of cases where the application's only secret is the user's
 passphrase. We do not want to store the passphrase, nor a hash of the
 passphrase on disk. Initialization process consists of:
 <ol>
 <li>1. Run the password through PBKDF2 with a random salt
 <li>2. Generate a random 256 bit AES key with a random IV
 <li>3. Use the derived key to encrypt the AES key in GCM mode
 <li>4. Write the ciphertext, iv, and salt to disk
 </ol>
 The exact data written to disk is represented by the SerializedSecretsV1
 class.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>static <a href="../../../info/guardianproject/cacheword/PassphraseSecrets.html" title="class in info.guardianproject.cacheword">PassphraseSecrets</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../info/guardianproject/cacheword/PassphraseSecrets.html#changePassphrase-Context-info.guardianproject.cacheword.PassphraseSecrets-char:A-">changePassphrase</a></span>(Context&nbsp;ctx,
                <a href="../../../info/guardianproject/cacheword/PassphraseSecrets.html" title="class in info.guardianproject.cacheword">PassphraseSecrets</a>&nbsp;current_secrets,
                char[]&nbsp;x_new_passphrase)</code>
<div class="block">Re-encrypts the secret key in current_secrets with a new derived key from
 x_new_passphrase.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../info/guardianproject/cacheword/PassphraseSecrets.html#destroy--">destroy</a></span>()</code>
<div class="block">Securely wipes all sensitive data</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>static <a href="../../../info/guardianproject/cacheword/PassphraseSecrets.html" title="class in info.guardianproject.cacheword">PassphraseSecrets</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../info/guardianproject/cacheword/PassphraseSecrets.html#fetchSecrets-Context-char:A-">fetchSecrets</a></span>(Context&nbsp;ctx,
            char[]&nbsp;x_passphrase)</code>
<div class="block">Attempts to decrypt the stored secrets with x_passphrase.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>javax.crypto.SecretKey</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../info/guardianproject/cacheword/PassphraseSecrets.html#getSecretKey--">getSecretKey</a></span>()</code>
<div class="block">Retrieve the AES secret key</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>static <a href="../../../info/guardianproject/cacheword/PassphraseSecrets.html" title="class in info.guardianproject.cacheword">PassphraseSecrets</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../info/guardianproject/cacheword/PassphraseSecrets.html#initializeSecrets-Context-char:A-">initializeSecrets</a></span>(Context&nbsp;ctx,
                 char[]&nbsp;x_passphrase)</code>
<div class="block">Generates a random AES key and encrypts it with a PBKDF2 key derived from
 x_passphrase.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getSecretKey--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSecretKey</h4>
<pre>public&nbsp;javax.crypto.SecretKey&nbsp;getSecretKey()</pre>
<div class="block">Retrieve the AES secret key</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>instance of <code>SecretKey</code></dd>
</dl>
</li>
</ul>
<a name="initializeSecrets-Context-char:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>initializeSecrets</h4>
<pre>public static&nbsp;<a href="../../../info/guardianproject/cacheword/PassphraseSecrets.html" title="class in info.guardianproject.cacheword">PassphraseSecrets</a>&nbsp;initializeSecrets(Context&nbsp;ctx,
                                                  char[]&nbsp;x_passphrase)</pre>
<div class="block">Generates a random AES key and encrypts it with a PBKDF2 key derived from
 x_passphrase. The resulting ciphertext is saved to disk. All sensitive
 variables are wiped.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>ctx</code> - </dd>
<dd><code>x_passphrase</code> - </dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>instance of <a href="../../../info/guardianproject/cacheword/PassphraseSecrets.html" title="class in info.guardianproject.cacheword"><code>PassphraseSecrets</code></a></dd>
</dl>
</li>
</ul>
<a name="fetchSecrets-Context-char:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>fetchSecrets</h4>
<pre>public static&nbsp;<a href="../../../info/guardianproject/cacheword/PassphraseSecrets.html" title="class in info.guardianproject.cacheword">PassphraseSecrets</a>&nbsp;fetchSecrets(Context&nbsp;ctx,
                                             char[]&nbsp;x_passphrase)
                                      throws java.security.GeneralSecurityException</pre>
<div class="block">Attempts to decrypt the stored secrets with x_passphrase. If successful,
 returns a PassphraseSecrets initialized with the secret key.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>ctx</code> - </dd>
<dd><code>x_passphrase</code> - WIPED</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>instance of <a href="../../../info/guardianproject/cacheword/PassphraseSecrets.html" title="class in info.guardianproject.cacheword"><code>PassphraseSecrets</code></a></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.security.GeneralSecurityException</code></dd>
</dl>
</li>
</ul>
<a name="changePassphrase-Context-info.guardianproject.cacheword.PassphraseSecrets-char:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>changePassphrase</h4>
<pre>public static&nbsp;<a href="../../../info/guardianproject/cacheword/PassphraseSecrets.html" title="class in info.guardianproject.cacheword">PassphraseSecrets</a>&nbsp;changePassphrase(Context&nbsp;ctx,
                                                 <a href="../../../info/guardianproject/cacheword/PassphraseSecrets.html" title="class in info.guardianproject.cacheword">PassphraseSecrets</a>&nbsp;current_secrets,
                                                 char[]&nbsp;x_new_passphrase)</pre>
<div class="block">Re-encrypts the secret key in current_secrets with a new derived key from
 x_new_passphrase. The resulting ciphertext is saved to disk.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>ctx</code> - </dd>
<dd><code>current_secrets</code> - NOT WIPED</dd>
<dd><code>x_new_passphrase</code> - WIPED</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>instance of <a href="../../../info/guardianproject/cacheword/PassphraseSecrets.html" title="class in info.guardianproject.cacheword"><code>PassphraseSecrets</code></a></dd>
</dl>
</li>
</ul>
<a name="destroy--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>destroy</h4>
<pre>public&nbsp;void&nbsp;destroy()</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../../../info/guardianproject/cacheword/ICachedSecrets.html#destroy--">ICachedSecrets</a></code></span></div>
<div class="block">Securely wipes all sensitive data</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../info/guardianproject/cacheword/ICachedSecrets.html#destroy--">destroy</a></code>&nbsp;in interface&nbsp;<code><a href="../../../info/guardianproject/cacheword/ICachedSecrets.html" title="interface in info.guardianproject.cacheword">ICachedSecrets</a></code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../info/guardianproject/cacheword/ICacheWordSubscriber.html" title="interface in info.guardianproject.cacheword"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../info/guardianproject/cacheword/PassphraseSecretsImpl.html" title="class in info.guardianproject.cacheword"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?info/guardianproject/cacheword/PassphraseSecrets.html" target="_top">Frames</a></li>
<li><a href="PassphraseSecrets.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
